USE [QLDSV]
GO

/****** Object:  StoredProcedure [dbo].[SP_DANGNHAP_SV]    Script Date: 9/22/2021 9:26:22 AM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO


CREATE PROC [dbo].[SP_DANGNHAP_SV]
@TENLOGIN NVARCHAR (50),@MASV NCHAR(10), @PASS NVARCHAR(50)
AS
DECLARE @TENUSER NVARCHAR(50), @CHECK INT
SELECT @TENUSER=NAME FROM sys.sysusers WHERE sid = SUSER_SID(@TENLOGIN)
EXEC @CHECK = SP_TimSV @MASV, @PASS
IF(@CHECK = 1)
BEGIN
 SELECT USERNAME = @MASV, 
  HOTEN = (SELECT HO+ ' '+ TEN FROM SINHVIEN  WHERE MASV = @MASV ),
   TENNHOM= NAME
   FROM sys.sysusers 
   WHERE UID = (SELECT GROUPUID 
                 FROM SYS.SYSMEMBERS 
                   WHERE MEMBERUID= (SELECT UID FROM sys.sysusers 
                                      WHERE NAME=@TENUSER))
END

GO

